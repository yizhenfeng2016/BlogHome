!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("MiniValine",[],t):"object"==typeof exports?exports.MiniValine=t():e.MiniValine=t()}(window,function(){var c=[function(e,t,n){"use strict";var a={on:function(e,t,n,o){for(var i=0,r=(e=e.split(" ")).length;i<r;i++)a.off(e[i],t,n,o),t.addEventListener?t.addEventListener(e[i],n,o||!1):t.attachEvent?t.attachEvent("on".concat(e[i]),n):t["on".concat(e[i])]=n},off:function(e,t,n,o){for(var i=0,r=(e=e.split(" ")).length;i<r;i++)t.removeEventListener?t.removeEventListener(e,n,o||!1):t.detachEvent?t.detachEvent("on".concat(e),n):t["on".concat(e)]=null}};e.exports=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VERSION="4.2.11";var o=t.MVUrl="https://cdn.jsdelivr.net/npm/minivaline@4.2.11";t.GBUrl="https://gravatar.loli.net/avatar/",t.EUrl=[o+"/imgs/alus",o+"/imgs/qq",o+"/imgs/Bilibilis",o+"/imgs/tieba",o+"/imgs/twemoji",o+"/imgs/weibo",o+"/imgs/funny"],t.pf="https://cdn.polyfill.io/v3/polyfill.min.js?features=es6",t.i18nUrl=o+"/i18n/",t.DEHash="9e63c80900d106cbbec5a9f4ea433a3e",t.MaxNL=6,t.PS=6,t.C={ip:"",comment:"",rid:"",at:"",nick:"",mail:"",mailMd5:"",link:"",ua:navigator.userAgent,url:location.pathname}},function(e,t,n){"use strict";e.exports=function(t){(t=t||{}).type=(t.type||"GET").toUpperCase(),t.dataType=t.dataType||"json";var e=function(e){var t,n=[];for(t in e)n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.push(("v="+Math.random()).replace(".","")),n.join("&")}(t.data),n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");n.onreadystatechange=function(){var e;4===n.readyState&&(200<=(e=n.status)&&e<300?t.success&&t.success(n.responseText,n.responseXML):t.fail&&t.fail(e))},"GET"==t.type?(n.open("GET",t.url+"?"+e,!0),n.send(null)):"POST"==t.type&&(n.open("POST",t.url,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(e))}},function(e,t,o){"use strict";e.exports=function(t,n){Promise.all([o.e(20),o.e(22)]).then(o.t.bind(null,58,7)).then(function(e){e=e.XSS;t.TEXT=e(t.TEXT),n(t)})}},function(e,t,n){"use strict";e.exports=function(e,t){var n,o,i;document.selection?(e.focus(),document.selection.createRange().text=t,e.focus()):e.selectionStart||"0"==e.selectionStart?(n=e.selectionStart,o=e.selectionEnd,i=e.scrollTop,e.value=e.value.substring(0,n)+t+e.value.substring(o,e.value.length),e.focus(),e.selectionStart=n+t.length,e.selectionEnd=n+t.length,e.scrollTop=i):(e.focus(),e.value+=t)}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e){if(t=localStorage&&localStorage.getItem("MiniValineCache")){for(var t=JSON.parse(t),n=["nick","link","mail"],o=0;o<n.length;o++){var i=n[o];e.el.querySelector(".v".concat(i)).value=t[i],e.C[i]=t[i]}""!==t.mail&&"DesertsP"===e.mode&&e.el.querySelector(".visitor_avatar").setAttribute("data-src","".concat(r.GBUrl+md5(t.mail.toLowerCase().trim()),"?size=80&d=robohash"))}}},function(e,t,n){"use strict";var l=(n=n(37))&&n.__esModule?n:{default:n};e.exports=function(e,t,n){var o=e.C.comment.match(/!\(:(.*?\.\w+):\)/g);if(o)for(var i=0;i<o.length;i++){var r=o[i].match(/!\(:(.*?\.\w+):\)/)[1],a=e.emoticon[r],c=new RegExp("!\\(:"+r.replace(/\./,"\\.")+":\\)","g");e.C.comment=e.C.comment.replace(c,'<img src="'.concat(a,'" alt="').concat(r,'" class="vemoticon-img">'))}t.TEXT=e.C.comment,(0,l.default)(e,t,n)}},function(e,t,n){"use strict";function v(e,t){for(var n=e.toString();n.length<t;)n="0".concat(n);return n}e.exports=function(e,t){try{var n=e.getTime(),o=(new Date).getTime()-n,i=Math.floor(o/864e5);if(0!==i)return i<0?t.now:i<365?"".concat(i," ").concat(t.days):(f=v((d=e).getDate(),2),m=v(d.getMonth()+1,2),d=v(d.getFullYear(),2),"".concat(d,"-").concat(m,"-").concat(f));var r=o%864e5,a=Math.floor(r/36e5);if(0!==a)return"".concat(a," ").concat(t.hours);var c=r%36e5,l=Math.floor(c/6e4);if(0!==l)return"".concat(l," ").concat(t.minutes);var s=c%6e4,u=Math.round(s/1e3);return 0===u?t.now:"".concat(u," ").concat(t.seconds)}catch(e){console.log(e)}var d,f,m}},function(e,t,n){"use strict";e.exports=function(e){var t=document.createElement("script");t.type="text/javascript",t.src=e;try{document.getElementsByTagName("head")[0].appendChild(t)}catch(e){}}},function(e,t,n){"use strict";function o(e){return window.MV||(console.log("%c MiniValine %c v"+a.VERSION+" ","color: white; background: #0078E7; padding:5px 0;","padding:4px;border:1px solid #0078E7;"),window.MV={},window.MV.v=a.VERSION),new r.default(e)}var i,r=(i=n(10))&&i.__esModule?i:{default:i},a=n(1);e.exports=o,e.exports.default=o},function(e,t,n){"use strict";var o=r(n(11)),i=r(n(16));function r(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=this;try{if(t.config=e,!document.querySelectorAll(t.config.el)[0])return;i.default.Config(t),i.default.initStyle(t),i.default.ActivateCode(t),i.default.script(t),i.default.i18n(t),i.default.initLibs(t)}catch(e){}}a.prototype.initCheck=function(){var t=this;try{var e=setInterval(function(){t.i18n&&(clearInterval(e),"DesertsP"===t.mode?(n.e(4).then(n.t.bind(null,47,7)).then(function(e){e=e.getEle;t.ele=e(t),t.Start()}),n.e(17).then(n.t.bind(null,48,7)).then(function(e){e=e.Vcard;t.Vcard=e(t)})):"xCss"===t.mode&&(t.config.closeUA||n.e(16).then(n.t.bind(null,49,7)).then(function(e){(0,e.init)()}),n.e(5).then(n.t.bind(null,50,7)).then(function(e){e=e.getEle;t.ele=e(t),t.Start()})),void 0!==t.config.barrager&&!t.config.barrager||n.e(18).then(n.t.bind(null,51,7)).then(function(e){e=e.Vbarrager;t.Vbarrager=e(t)}))},5)}catch(t){}},a.prototype.Start=function(){var e=this;try{o.default.el(e),o.default.loading(e),e.nodata.show(),o.default.smiles(e),i.default.setAV(e),i.default.visitor(e)}catch(e){return}try{i.default.cloudFlag(e),e.loading.hide(e.parentCount),e.loading.show(),i.default.initCount(e),i.default.insertComment(e,o.default),i.default.parentQuery(e),i.default.nestQuery(e),i.default.alert(e),i.default.inputs(e),i.default.previewEvt(e),i.default.smileEvt(e),"DesertsP"===e.mode&&i.default.startEvt(e),void 0!==e.config.barrager&&!e.config.barrager||i.default.barrager(e),i.default.getCache(e),i.default.resetForm(e),i.default.uploadImage(e),i.default.cancelReply(e),i.default.smileBtnEvt(e),i.default.previewBtnEvt(e),i.default.atEvt(e),i.default.submitBtnEvt(e),i.default.smile(e)}catch(e){}},e.exports=a},function(e,t,n){"use strict";var o=a(n(12)),i=a(n(13)),r=a(n(14)),n=a(n(15));function a(e){return e&&e.__esModule?e:{default:e}}e.exports={vcard:o.default,loading:i.default,smiles:r.default,el:n.default}},function(e,t,n){"use strict";var v=n(1),p=(n=n(7))&&n.__esModule?n:{default:n};e.exports=function(e,t){t.set("nick",t.get("nick").slice(0,20).trim().replace(/&/g,"&amp;").replace(/\//g,"&#x2F").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"));var n=t.get("mailMd5"),n="".concat(v.GBUrl+n,"?size=80&d=robohash");if(void 0!==e.config.barrager&&!e.config.barrager||e.Vbarrager(e,t,n),"DesertsP"===e.mode)return e.Vcard(e,t,n);if("xCss"===e.mode){var o,i=t.get("ua")||"",r="",a=v.MVUrl+"/imgs/svg/";if(i&&!e.config.closeUA){i=uaparser(i);try{i.browser&&i.browser.name?(r+='<span class="vsys"><i><embed class="msvg" src="'+a,l=i.browser.name.toLowerCase(),["samsung browser"].includes(l)?r+="mobile-alt":["android browser"].includes(l)?r+="android":["mobile safari","safari"].includes(l)?r+="safari":["ie","iemobile"].includes(l)?r+="internet-explorer":["wechat"].includes(l)?r+="weixin":["qqbrowser","qqbrowserlite","qq"].includes(l)?r+="qq":["baiduboxapp","baidu"].includes(l)?r+="paw":["chrome","chromium","chrome headless","chrome webview"].includes(l)?r+="chrome":["opera mobi","opera","opera coast","opera mini","opera tablet"].includes(l)?r+="opera":["firefox","edge"].includes(l)?r+=l:r+="snapchat-ghost",r+='.svg"/></i>'+i.browser.name+" "+(i.browser.version||"")+"</span> "):r+='<span class="vsys"><i><embed class="msvg" src="'+a+'stars.svg"/></i>Magical APP</span>',i.os&&i.os.name?(r+='<span class="vsys"><i><embed class="msvg" src="'+a,o=i.os.name.toLowerCase(),["mac os","ios"].includes(o)?r+="apple":["chromium os"].includes(o)?r+="chrome":["firefox os"].includes(o)?r+="firefox":["windows phone","windows"].includes(o)?r+="windows":["android","linux","ubuntu","suse","redhat","fedora","centos","blackberry"].includes(o)?r+=o:r+="snapchat-ghost",r+='.svg"/></i>'+i.os.name+" "+(i.os.version||"")+"</span>"):r+='<span class="vsys"><i><embed class="msvg" src="'+a+'magic.svg"/></i>Magical OS</span>'}catch(e){}}if(e.config.region)try{var c=t.get("log").region.data.location;c&&(r+='<span class="vsys"><i><embed class="msvg" src="'+a+'map.svg"/></i>'+c+"</span>")}catch(e){}var l="";if(!e.config.closeFlag&&!e.config.cloudflag)try{e.master=e.master.map(function(e){return e.toLowerCase()}),e.friends=e.friends.map(function(e){return e.toLowerCase()});var s=e.master.includes(t.get("mailMd5").toLowerCase()),u=e.friends.includes(t.get("mailMd5").toLowerCase()),l=s?'<span class="vtag vmaster">'+e.tagMeta[0]+"</span>":u?'<span class="vtag vfriend">'+e.tagMeta[1]+"</span>":'<span class="vtag vvisitor">'+e.tagMeta[2]+"</span>"}catch(e){}if(!e.config.closeFlag&&e.config.cloudflag)try{var d=e.cloudFlag.Roles,f=t.get("mailMd5").toLowerCase(),m=e.cloudFlag.Users[f];l=m?'<span class="vtag" style="background:'+"".concat(e.cloudFlag.Roles[m]&&e.cloudFlag.Roles[m].color?e.cloudFlag.Roles[m].color:"#6cf")+';">'+"".concat(e.cloudFlag.Roles[m]&&e.cloudFlag.Roles[m].nick?e.cloudFlag.Roles[m].nick:"visitor")+"</span>":'<span class="vtag" style="background:'+"".concat(d.visitor&&d.visitor.color?d.visitor.color:"#828282")+';">'+"".concat(d.visitor&&d.visitor.nick?d.visitor.nick:"visitor")+"</span>"}catch(e){}return'<div class="vcomment-body"><div class="vhead" >'+'<img class="vavatar lazyload" data-src="'.concat(n,'"/>')+"<a rid='".concat(t.id,"' at='@").concat(t.get("nick"),'\' class="vat" id="at-').concat(t.id,'">').concat(e.i18n.reply,"</a>")+'<div class="vmeta-info">'.concat(t.get("link")?'<a class="vname" href="'.concat(t.get("link"),'" target="_blank" rel="nofollow" > ').concat(t.get("nick"),"</a>").concat(l,'<span class="vsysinfo">').concat(r,"</span>"):'<span class="vname">'.concat(t.get("nick"),"</span> ").concat(l," ").concat(r))+'<br/><span class="vtime">'.concat((0,p.default)(t.get("createdAt"),e.i18n),"</span>")+"</div></div>"+'<section class="text-wrapper"  id="comment-'.concat(t.id,'">')+'<div class="vcomment">'.concat(t.get("comment"),"</div>")+'</section></div><div class="vcomment-children"><div class="vshow-children-wrapper" style="display: none"></div>'+'<ul class="vlist" id="children-list-'.concat(t.id,'"></ul>')+"</div>"}}},function(e,t,n){"use strict";e.exports=function(t){var n=t.el.querySelector(".vempty"),e=(t.nodata={show:function(e){n.innerHTML=e||t.i18n.noCommentYet,n.setAttribute("style","display:block;")},hide:function(){n.setAttribute("style","display:none;")}},'<div class="spinner"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div><div class="r5"></div></div>'),o=t.el.querySelector(".vloading"),i=(o.innerHTML=e,t.loading={show:function(){o.setAttribute("style","display:block;"),t.nodata.hide()},hide:function(e){o.setAttribute("style","display:none;"),0===e&&t.nodata.show()}},t.el.querySelector(".vsubmitting"));i.innerHTML=e,t.submitting={show:function(){i.setAttribute("style","display:block;")},hide:function(){i.setAttribute("style","display:none;"),t.nodata.hide()}}}},function(e,t,n){"use strict";e.exports=function(d){var f=setInterval(function(){if(void 0!==d.emoticonList&&0!=d.emoticonList.length){clearInterval(f);for(var e=d.el.querySelector(".vsmile-icons ul"),t=d.el.querySelector(".vsmile-bar ul"),n=d.emoticonList||[],o=0;o<n.length;o++){for(var i=document.createElement("li"),r=document.createElement("li"),a=0;a<n[o].length;a++){var c=document.createElement("img");c.setAttribute("data-src","".concat(n[o][a])),c.setAttribute("class","lazyload");try{i.appendChild(c)}catch(e){}if(0===a){(c=document.createElement("img")).setAttribute("src","".concat(n[o][0])),c.removeAttribute("class","lazyload");try{r.appendChild(c)}catch(e){}}}try{e.appendChild(i)}catch(e){}try{t.appendChild(r)}catch(e){}}try{d.el.querySelector(".vsmile-icons > ul > li:nth-child(1)").style.display="block";for(var l=document.querySelectorAll(".vsmile-bar > ul > li"),s=document.querySelectorAll(".vsmile-icons > ul > li"),u=0;u<l.length;u++)l[u].index=u,l[u].onclick=function(){for(var e=0;e<l.length;e++)l[e].className="",s[e].style.display="none";this.className="active",s[this.index].style.display="block"}}catch(e){}}},10)}},function(e,t,n){"use strict";e.exports=function(e){var t="[object HTMLDivElement]"===Object.prototype.toString.call(e.config.el)?e.config.el:document.querySelectorAll(e.config.el)[0];"[object HTMLDivElement]"===Object.prototype.toString.call(t)&&(e.el=t,e.el.classList.add("MiniValine"),e.el.classList.add("markdown-body"),e.el.innerHTML=e.ele)}},function(e,t,n){"use strict";var o=V(n(17)),i=V(n(18)),r=V(n(19)),a=V(n(20)),c=V(n(21)),l=V(n(23)),s=V(n(24)),u=V(n(25)),d=V(n(26)),f=V(n(5)),m=V(n(27)),v=V(n(28)),p=V(n(29)),g=V(n(30)),h=V(n(31)),y=V(n(32)),b=V(n(33)),w=V(n(34)),M=V(n(35)),S=V(n(36)),C=V(n(39)),x=V(n(40)),_=V(n(41)),q=V(n(42)),A=V(n(43)),k=V(n(44)),E=V(n(45)),n=V(n(46));function V(e){return e&&e.__esModule?e:{default:e}}e.exports={Config:o.default,i18n:i.default,setAV:r.default,smile:a.default,script:c.default,initStyle:l.default,initLibs:s.default,uploadImage:u.default,alert:d.default,initCount:m.default,smileEvt:v.default,startEvt:p.default,resetForm:g.default,cancelReply:h.default,smileBtnEvt:y.default,previewBtnEvt:b.default,inputs:w.default,atEvt:M.default,submitBtnEvt:S.default,insertComment:C.default,nestQuery:x.default,parentQuery:_.default,ActivateCode:q.default,previewEvt:A.default,visitor:k.default,barrager:E.default,cloudFlag:n.default,getCache:f.default}},function(e,t,n){"use strict";var o=n(1);e.exports=function(e){e.emoticonUrl=e.config.emoticonUrl||o.EUrl,e.lang=e.config.lang||navigator.language||navigator.userLanguage,e.maxNestLevel=e.config.maxNest||o.MaxNL,e.pageSize=e.config.pageSize||o.PS,e.adminEmailMd5=e.config.adminEmailMd5||"",e.math=e.config.math,e.md=e.config.md,e.visitor=e.config.visitor,e.tagMeta=e.config.tagMeta||[],e.master=e.config.master||[],e.friends=e.config.friends||[],e.mode=e.config.mode||"DesertsP",e.placeholder=e.config.placeholder||"",e.C=o.C,e.C.url=e.config.pathname||location.pathname,e.role=e.config.role||"admin"}},function(module,exports,__webpack_require__){"use strict";var _Default=__webpack_require__(1),_ajax=__webpack_require__(2),_ajax2=_interopRequireDefault(_ajax);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var i18n=function i18n(root){var s;window.MV.i18n?(root.i18n=window.MV.i18n,window.MV.getI18n=0):(s=localStorage&&localStorage.getItem("MiniValineI18n"),s?(s=JSON.parse(s),s.lang==root.lang?(root.i18n=s.i18n,window.MV.i18n=root.i18n,window.MV.getI18n=0):window.MV.getI18n=1):window.MV.getI18n=1,window.MV.getI18n&&(0,_ajax2.default)({url:_Default.i18nUrl+root.lang+"/index.json",type:"GET",success:function success(data){data=eval("("+data+")"),root.i18n=data,window.MV.i18n=root.i18n,localStorage&&localStorage.setItem("MiniValineI18n",JSON.stringify({lang:root.lang,i18n:root.i18n}))}}))};module.exports=i18n},function(e,t,n){"use strict";e.exports=function(e){var t,n="https://";if(!e.config.serverURLs)switch(e.config.appId.slice(-9)){case"-9Nh9j0Va":n+="tab.leancloud.cn";break;case"-MdYXbMMI":n+="console.leancloud.app";break;default:n+="avoscloud.com"}t=e.config.serverURLs||n;try{AV.init({appId:e.config.appId,appKey:e.config.appKey,serverURLs:t})}catch(e){}e.v=AV}},function(module,exports,__webpack_require__){"use strict";var _ajax=__webpack_require__(2),_ajax2=_interopRequireDefault(_ajax);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var smile=function(e){if(window.MV.emoticonUrl=e.emoticonUrl,!window.MV.emoticonList){var t=localStorage&&localStorage.getItem("MiniValineSmile");if(t)if(equar((t=JSON.parse(t)).emoticonUrl,e.emoticonUrl)){e.emoticonList=t.emoticonList,e.emoticon=[];for(var n=0;n<e.emoticonList.length;n++)for(var o=0;o<e.emoticonList[n].length;o++)e.emoticon[e.emoticonList[n][o].split("/")[e.emoticonList[n][o].split("/").length-1]]=e.emoticonList[n][o];window.MV.emoticonList=e.emoticonList,window.MV.emoticon=e.emoticon,window.MV.getSmile=0}else window.MV.getSmile=1;else window.MV.getSmile=1;if(window.MV.getSmile){e.emoticonList=[],e.emoticon=[];for(var i=0;i<e.emoticonUrl.length;i++)getSmile(e,e.emoticonUrl[i]);window.MV.emoticonList=e.emoticonList,window.MV.emoticon=e.emoticon}else e.emoticonList=window.MV.emoticonList,e.emoticon=window.MV.emoticon;setTimeout(function(){localStorage&&localStorage.setItem("MiniValineSmile",JSON.stringify({emoticonUrl:window.MV.emoticonUrl,emoticonList:window.MV.emoticonList}))},5e3)}},getSmile=function getSmile(root,Url){(0,_ajax2.default)({url:Url+"/index.json",type:"GET",success:function success(data){data=eval("("+data+")");for(var tmp=[],i=0;i<data[0].length;i++)tmp.push(Url+"/"+data[0][i]),root.emoticon[data[0][i]]=Url+"/"+data[0][i];root.emoticonList.push(tmp)}})};function equar(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return;return 1}}module.exports=smile},function(e,t,n){"use strict";var o=n(1),i=a(n(8)),r=a(n(22));function a(e){return e&&e.__esModule?e:{default:e}}e.exports=function(e){e.config.NoRecordIP||(void 0===window.MV.ip?(0,r.default)(e):e.C.ip=window.MV.ip),void 0===window.MV.pf&&((0,i.default)(o.pf),window.MV.pf=!0),void 0!==e.config.barrager&&!e.config.barrager||void 0!==window.MV.jq||("undefined"==typeof jQuery&&(0,i.default)("https://cdn.jsdelivr.net/npm/jquery"),window.MV.jq=!0),void 0!==e.visitor&&!e.visitor||(0,i.default)("https://cdn.jsdelivr.net/npm/fingerprintjs2")}},function(module,exports,__webpack_require__){"use strict";var _ajax=__webpack_require__(2),_ajax2=_interopRequireDefault(_ajax);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var GetIP=function GetIP(root){try{(0,_ajax2.default)({url:"https://ip.zxinc.org/api.php",type:"GET",data:{type:"json"},success:function success(data){data=eval("("+data+")"),window.MV.fuck=1,window.MV.region=data,root.C.ip=data.data.myip,window.MV.ip=root.C.ip}})}catch(e){}};module.exports=GetIP},function(e,t,n){"use strict";e.exports=function(e){var t;e.config.closeCSS||(t=setInterval(function(){"undefined"!=typeof Promise&&(clearInterval(t),"DesertsP"===e.mode?Promise.all([n.e(0),n.e(12)]).then(n.bind(null,52)):"xCss"===e.mode&&Promise.all([n.e(0),n.e(15)]).then(n.bind(null,53)),void 0!==e.config.danmu&&!e.config.danmu||Promise.all([n.e(0),n.e(13)]).then(n.bind(null,54)),e.config.dark&&Promise.all([n.e(0),n.e(14)]).then(n.bind(null,55)))},5))}},function(e,t,n){"use strict";e.exports=function(t){var e=setInterval(function(){"undefined"!=typeof Promise&&(clearInterval(e),Promise.all([n.e(0),n.e(10),n.e(19),n.e(6)]).then(n.t.bind(null,56,7)).then(function(e){(0,e.lib)(),t.initCheck()}))},5)}},function(e,t,n){"use strict";var o=i(n(0)),l=i(n(4));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=function(i){function r(e){if(e.length)for(var t=0;t<e.length;t++)!function(){var n=e[t],o="![Uploading ".concat(n.name,"]()");(0,l.default)(a,o),c(n,function(e,t){!e&&t&&(a.value=a.value.replace(o,"\r\n![".concat(n.name,"](").concat(t.data.url,")")),i.C.comment=a.value)})}()}var a=i.el.querySelector(".veditor"),c=(o.default.on("keydown",document,function(e){var t=(e=event||e).keyCode||e.which||e.charCode;(e.ctrlKey||e.metaKey)&&13===t&&i.submitEvt(),9===t&&"veditor"==(document.activeElement.className||"")&&(e.preventDefault(),(0,l.default)(a,"    "))}),o.default.on("paste",document,function(e){var e="clipboardData"in e?e.clipboardData:e.originalEvent&&e.originalEvent.clipboardData||window.clipboardData,t=e&&e.items,n=[];if(t&&0<t.length){for(var o=0;o<t.length;o++)if(-1!==t[o].type.indexOf("image")){n.push(t[o].getAsFile());break}r(n)}}),function(e,t){var n=new FormData,o=(n.append("image",e),window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"));o.onreadystatechange=function(){if(4===o.readyState&&200===o.status)try{var e=JSON.parse(o.responseText);t&&t(null,e)}catch(e){t&&t(e)}else t&&t(o.status)},o.onerror=function(e){console.log(e)},o.open("POST","https://pic.alexhchu.com/api/upload",!0),o.send(n)}),e=document.getElementsByClassName("veditor")[0];e.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()}),e.addEventListener("dragenter",function(e){e.preventDefault(),e.stopPropagation()}),e.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation();e=this.files||e.dataTransfer.files;r(e)})}},function(e,t,n){"use strict";var a=(n=n(0))&&n.__esModule?n:{default:n};e.exports=function(i){var r=i.el.querySelector(".vmark");i.alert={show:function(t){r.innerHTML='<div class="valert txt-center"><div class="vtext">'.concat(t.text,'</div><div class="vbtns"></div></div>');var e=r.querySelector(".vbtns"),n='<button class="vcancel vbtn">'.concat(t.ctxt||i.i18n.cancel,"</button>"),o='<button class="vsure vbtn">'.concat(t.otxt||i.i18n.continue,"</button>");e.innerHTML="".concat(n).concat(t.type&&o),r.querySelector(".vcancel").addEventListener("click",function(e){i.alert.hide()}),r.setAttribute("style","display:block;"),t.type&&(e=r.querySelector(".vsure"),a.default.on("click",e,function(e){i.alert.hide(),t.cb&&t.cb()}))},hide:function(){r.setAttribute("style","display:none;")}}}},function(e,t,n){"use strict";e.exports=function(t){var e=new t.v.Query("Comment"),n=(e.equalTo("url",t.C.url),new t.v.Query("Comment")),e=(n.equalTo("url","".concat(t.C.url,"/")),AV.Query.or(e,n));e.notEqualTo("isSpam",!0),e.count().then(function(e){t.el.querySelector(".count").innerHTML=e}).catch(function(e){console.log(e),t.el.querySelector(".count").innerHTML=0})}},function(e,t,n){"use strict";var o=r(n(0)),i=r(n(4));function r(e){return e&&e.__esModule?e:{default:e}}e.exports=function(n){var e=n.el.querySelector(".vsmile-icons");o.default.on("click",e,function(e){var t=n.el.querySelector(".veditor"),e=e.target.src;void 0!==e&&(e="!(:".concat(decodeURI(e).replace(/^.*\/(.*)$/,"$1"),":)"),(0,i.default)(t,e),n.C.comment=t.value,(e=n.el.querySelector(".vsubmit")).getAttribute("disabled")&&e.removeAttribute("disabled"))})}},function(e,t,n){"use strict";var o=(n=n(0))&&n.__esModule?n:{default:n};e.exports=function(t){var n=t.el.querySelector(".commentTrigger");o.default.on("click",n,function(e){n.setAttribute("style","display:none"),t.el.querySelector(".auth-section").removeAttribute("style"),t.el.querySelector(".veditor").focus()})}},function(e,t,n){"use strict";var r=(n=n(5))&&n.__esModule?n:{default:n};e.exports=function(n){var o=n.el.querySelector(".vsmile-icons"),i=n.el.querySelector(".vpreview-text");n.reset=function(){for(var e in n.mapping){var t;n.mapping.hasOwnProperty(e)&&(t=n.mapping[e],n.el.querySelector(".".concat(e)).value="",n.C[t]="")}n.C.rid="",n.C.nick="",n.C.at="",(n.el.querySelector(".vinputs-area  textarea").placeholder="",r.default)(n),n.previewEvt(n),o.getAttribute("triggered")&&(o.setAttribute("style","display:none;"),o.removeAttribute("triggered")),i.getAttribute("triggered")&&(i.setAttribute("style","display:none;"),i.removeAttribute("triggered")),n.el.querySelector(".vcancel-comment-reply").setAttribute("style","display:none");try{n.el.querySelector("#vinputs-placeholder").appendChild(n.el.querySelector(".vinputs-wrap"))}catch(e){}}}},function(e,t,n){"use strict";var o=(n=n(0))&&n.__esModule?n:{default:n};e.exports=function(t){o.default.on("click",t.el.querySelector(".cancel-reply-btn"),function(e){t.reset()})}},function(e,t,n){"use strict";var r=(n=n(0))&&n.__esModule?n:{default:n};e.exports=function(e){var t=e.el.querySelector(".vemoji-btn"),n=e.el.querySelector(".vpreview-btn"),o=e.el.querySelector(".vpreview-text"),i=e.el.querySelector(".vsmile-body");r.default.on("click",t,function(e){o.getAttribute("triggered")&&(o.setAttribute("style","display:none;"),o.removeAttribute("triggered"),n.classList.remove("actived")),i.getAttribute("triggered")?(i.setAttribute("style","display:none;"),i.removeAttribute("triggered"),t.classList.remove("actived")):(i.removeAttribute("style"),i.setAttribute("triggered",1),t.classList.add("actived"))})}},function(e,t,n){"use strict";var a=(n=n(0))&&n.__esModule?n:{default:n};e.exports=function(t){var n=t.el.querySelector(".vpreview-btn"),o=t.el.querySelector(".vemoji-btn"),i=t.el.querySelector(".vpreview-text"),r=t.el.querySelector(".vsmile-icons");a.default.on("click",n,function(e){r.getAttribute("triggered")&&(r.setAttribute("style","display:none;"),r.removeAttribute("triggered"),o.classList.remove("actived")),i.getAttribute("triggered")?(i.setAttribute("style","display:none;"),i.removeAttribute("triggered"),n.classList.remove("actived")):(n.classList.add("actived"),""===t.C.comment?t.inputs.comment.focus():t.previewEvt(t))})}},function(e,t,n){"use strict";var i=(n=n(0))&&n.__esModule?n:{default:n};e.exports=function(o){for(var e in o.inputs={},o.mapping={veditor:"comment",vnick:"nick",vlink:"link",vmail:"mail"},o.mapping)o.mapping.hasOwnProperty(e)&&function(){var t=o.mapping[e],n=o.el.querySelector(".".concat(e));o.inputs[t]=n,i.default.on("input",n,function(e){o.C[t]=n.value,o.previewEvt(o)})}()}},function(e,t,n){"use strict";var c=(n=n(0))&&n.__esModule?n:{default:n};e.exports=function(a){a.AtEvt=function(o){var i=o.getAttribute("id"),r=o.querySelector("#at-".concat(i));c.default.on("click",r,function(e){var t=r.getAttribute("at"),n=r.getAttribute("rid"),n=(a.C.rid=n,a.C.at=t,a.el.querySelector(".vinputs-area  textarea").placeholder=t,a.inputs.comment.value="".concat(a.inputs.comment.value),o.querySelector("#comment-".concat(i)));try{n.appendChild(a.el.querySelector(".vinputs-wrap"))}catch(e){}a.el.querySelector(".vcancel-comment-reply").removeAttribute("style"),"DesertsP"===a.mode&&(a.el.querySelector(".commentTrigger").setAttribute("style","display:none"),a.el.querySelector(".auth-section").removeAttribute("style"),a.el.querySelector(".veditor").focus()),a.inputs.comment.focus()})}}},function(e,t,n){"use strict";var a=o(n(0)),c=o(n(6)),l=o(n(38));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=function(i){var r=i.el.querySelector(".vsubmit"),o=(i.submitEvt=function(e){r.getAttribute("disabled")?i.alert.show({type:0,text:i.i18n.wait+'ヾ(๑╹◡╹)ﾉ"',ctxt:i.i18n.ok}):""!==i.C.comment?""!==i.C.nick?(0,c.default)(i,i,function(e){e.C.comment=e.TEXT,""!==e.C.at&&(t='<a class="at" href=\'#'.concat(e.C.rid,"'>").concat(e.C.at,"</a>"),e.C.comment=t+" , "+e.C.comment);var t=l.default.mail(e.C.mail),n=l.default.link(e.C.link);e.C.mail=t.k?t.v:"",e.C.link=n.k?n.v:"",e.C.mailMd5=md5(e.C.mail),t.k&&n.k?o():e.alert.show({type:0,text:e.i18n.inputTips,ctxt:e.i18n.confirm})}):i.inputs.nick.focus():i.inputs.comment.focus()},function(){r.setAttribute("disabled",!0),i.submitting.show();var e,t=new(i.v.Object.extend("Comment"));for(e in i.C)if(i.C.hasOwnProperty(e)){if("at"===e)continue;var n=i.C[e];t.set(e,n)}try{var o=i.C.ip;o&&(/^((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$/.test(o)||/^([\da-fA-F]{1,4}:){7}[\da-fA-F]{1,4}$/.test(o))&&"127.0.0.1"!=o||(window.MV.fuck=0,kill())}catch(e){}try{window.MV.MC&&window.MV.MC.util&&window.MV.MC.util.Visitor()}catch(e){}t.setACL(((o=new i.v.ACL).setWriteAccess("role:"+i.role,!0),o.setPublicReadAccess(!0),o.setPublicWriteAccess(!1),o)),t.save({log:window.MV}).then(function(e){localStorage&&localStorage.setItem("MiniValineCache",JSON.stringify({nick:i.C.nick,link:i.C.link,mail:i.C.mail}));var t=i.el.querySelector(".count");t.innerText=Number(t.innerText)+1,""===i.C.rid?i.insertComment(e,null,!0):(t=i.el.querySelector("#children-list-".concat(i.C.rid)),i.insertComment(e,t,!0)),r.removeAttribute("disabled"),i.submitting.hide(),i.nodata.hide(),i.reset()}).catch(function(e){i.submitting.hide()})});a.default.on("click",r,i.submitEvt)}},function(e,t,o){"use strict";var n,i=(n=o(3))&&n.__esModule?n:{default:n};e.exports=function(e,t,n){e.md||void 0===e.config.md?Promise.all([o.e(1),o.e(11),o.e(8)]).then(o.t.bind(null,57,7)).then(function(e){e=e.markdown;t.TEXT=e(t.TEXT),(0,i.default)(t,n)}):(0,i.default)(t,n)}},function(e,t,n){"use strict";e.exports={mail:function(e){return{k:/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(e),v:e}},link:function(e){return{k:!(0<(e=0<e.length?/^(http|https)/.test(e)?e:"http://".concat(e):e).length)||/(http|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/.test(e),v:e}}}},function(e,t,n){"use strict";var o=(n=n(0))&&n.__esModule?n:{default:n};e.exports=function(l,s){l.insertComment=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],o=document.createElement("li");o.setAttribute("class","vcard"),o.setAttribute("id",e.id),o.innerHTML=s.vcard(l,e),l.ActivateCode(l);for(var e=t||l.el.querySelector(".vlist"),t=e.querySelectorAll("li"),i=o.querySelectorAll("a"),r=0,a=i.length;r<a;r++){var c=i[r];c&&"at"!==c.getAttribute("class")&&(c.setAttribute("target","_blank"),c.setAttribute("rel","nofollow"))}if(n)e.insertBefore(o,t[0]);else try{e.appendChild(o)}catch(e){}n=o.querySelector(".vcomment");return u(n),l.AtEvt(o),o};var u=function(t){180<t.offsetHeight&&(t.classList.add("expand"),o.default.on("click",t,function(e){t.setAttribute("class","vcomment")}))}}},function(e,t,n){"use strict";var l=o(n(0)),s=o(n(3));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=function(c){c.nestQuery=function(n){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=n.querySelector(".vcomment-children"),r=i.querySelector(".vlist"),a=n.getAttribute("id");o<=0&&i.setAttribute("style","margin-left: 0 !important"),o>=c.maxNestLevel?c.v.Query.doCloudQuery("select count(*) from Comment where rid='".concat(a,"' and (url='").concat(c.C.url,"' or url='","".concat(c.C.url,"/"),"') order by -createdAt")).then(function(e){var t;0<e.count&&((t=i.querySelector(".vshow-children-wrapper")).setAttribute("style","display: block !important;"),t.innerHTML='<span class="vshow-children" rid="'.concat(a,'">').concat(c.i18n.more,"</span>"),e=t.querySelector(".vshow-children"),l.default.on("click",e,function(e){t.setAttribute("style","display: none !important;"),c.nestQuery(n,-1e3)}))},function(e){console.log(e)}):setTimeout(function(){c.v.Query.doCloudQuery("select nick, comment, link, rid, isSpam, mailMd5, ua ".concat(c.config.region?",log":""," from Comment where rid='").concat(a,"' and (url='").concat(c.C.url,"' or url='","".concat(c.C.url,"/"),"') order by -createdAt")).then(function(n){var e=(n=n&&n.results||[]).length;if(e)for(var t=0;t<e;t++)!function(t){n[t].get("isSpam")||(n[t].TEXT=n[t].get("comment"),(0,s.default)(n[t],function(e){n[t].set("comment",e.TEXT);e=c.insertComment(n[t],r,!0);c.nestQuery(e,o+1)}))}(t)}).catch(function(e){c.loading.hide(c.parentCount)})},60*o)}}},function(e,t,n){"use strict";var l=o(n(0)),s=o(n(3));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=function(a){var c=1;a.parentCount=0,a.parentQuery=function(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;a.loading.show(),a.v.Query.doCloudQuery("select nick, comment, link, rid, isSpam, mailMd5, ua ".concat(a.config.region?",log":""," from Comment where (rid='' or rid is not exists) and (url='").concat(a.C.url,"' or url='","".concat(a.C.url,"/"),"') order by -createdAt limit ").concat((r-1)*a.pageSize,",").concat(a.pageSize)).then(function(n){var e=(n=n&&n.results||[]).length;if(e){for(var t=0;t<e;t++)!function(t){if(0==t&&a.loading.hide(a.parentCount),n[t].get("isSpam"))return;n[t].TEXT=n[t].get("comment"),(0,s.default)(n[t],function(e){n[t].set("comment",e.TEXT);e=a.insertComment(n[t],a.el.querySelector(".vlist"),!1);e.setAttribute("style","margin-bottom: .5em"),a.nestQuery(e)})}(t);var o=a.el.querySelector(".vpage"),i=(o.innerHTML=a.pageSize*r<a.parentCount?'<div id="vmore" class="more">'.concat(a.i18n.more,"</div>"):"",o.querySelector("#vmore"));i&&l.default.on("click",i,function(e){o.innerHTML="",a.parentQuery(++c)})}try{void 0===window.MV.barrager.bottom||void 0!==a.config.barrager&&1!=a.config.barrager||(window.MV.barrager.enable=0)}catch(e){}a.loading.hide(a.parentCount)}).catch(function(e){a.loading.hide(a.parentCount)})},a.v.Query.doCloudQuery("select count(*) from Comment where (rid='' or rid is not exists) and (url='".concat(a.C.url,"' or url='","".concat(a.C.url,"/"),"') order by -createdAt")).then(function(e){a.parentCount=e.count,a.parentQuery(1)}).catch(function(e){console.log(e)})}},function(e,t,n){"use strict";e.exports=function(e){e.ActivateCode=function(t){setTimeout(function(){document.getElementsByTagName("pre").length&&Promise.all([n.e(0),n.e(1),n.e(9)]).then(n.bind(null,59))},500),0!=t.math&&n.e(7).then(n.t.bind(null,60,7)).then(function(e){(0,e.MathJaxSupport)(t)})}}},function(e,t,n){"use strict";var r=(n=n(6))&&n.__esModule?n:{default:n};e.exports=function(e){e.previewEvt=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=t.el.querySelector(".vpreview-btn"),e=t.el.querySelector(".vpreview-text"),i=t.el.querySelector(".veditor");(0,r.default)(t,e,function(e){e.innerHTML=e.TEXT,e.removeAttribute("style"),e.setAttribute("triggered",1),o.classList.add("actived"),i.value?autosize(i):autosize.destroy(i),t.ActivateCode(t,n)})}}},function(e,t,n){"use strict";e.exports=function(t){void 0!==t.visitor&&!t.visitor||n.e(21).then(n.t.bind(null,61,7)).then(function(e){(0,e.MCo)(t.config)})}},function(e,t,n){"use strict";e.exports=function(e){window.MV.barrager={},window.MV.barrager.enable=1;var t=localStorage&&localStorage.getItem("MiniValineBarrager");t?(t=JSON.parse(t),window.MV.barrager.url=t.url):window.MV.barrager.url=[],function(e,t){for(var n=0;n<e.length;n++)if(t===e[n])return 1}(window.MV.barrager.url,document.location.href)||(window.MV.barrager.url.push(document.location.href),localStorage&&localStorage.setItem("MiniValineBarrager",JSON.stringify({url:window.MV.barrager.url})),n.e(3).then(n.t.bind(null,62,7)).then(function(e){(0,e.barrager)()}))}},function(e,t,n){"use strict";e.exports=function(n){if(n.config.cloudflag)try{n.cloudFlag={},AV.Query.doCloudQuery("select * from Roles limit 100000000  order by -createdAt").then(function(e){n.cloudFlag.Roles={};for(var t=0;t<e.results.length;t++)n.cloudFlag.Roles[e.results[t].get("name")]={nick:e.results[t].get("nick"),color:e.results[t].get("color")}},function(e){console.log(e)}),AV.Query.doCloudQuery("select * from Users limit 100000000  order by -createdAt").then(function(e){n.cloudFlag.Users={};for(var t=0;t<e.results.length;t++)n.cloudFlag.Users[e.results[t].get("emailhash").toLowerCase()]=e.results[t].get("role")},function(e){console.log(e)})}catch(n){}}}];function d(e){for(var t,n,o=e[0],i=e[1],r=0,a=[];r<o.length;r++)n=o[r],Object.prototype.hasOwnProperty.call(g,n)&&g[n]&&a.push(g[n][0]),g[n]=0;for(t in i)Object.prototype.hasOwnProperty.call(i,t)&&(c[t]=i[t]);for(m&&m(e);a.length;)a.shift()()}var f={},g={2:0};function h(e){if(f[e])return f[e].exports;var t=f[e]={i:e,l:!1,exports:{}};return c[e].call(t.exports,t,t.exports,h),t.l=!0,t.exports}h.e=function(o){var e,i,r,t,a,n=[],c=g[o];return 0!==c&&(c?n.push(c[2]):(e=new Promise(function(e,t){c=g[o]=[e,t]}),n.push(c[2]=e),(i=document.createElement("script")).charset="utf-8",i.timeout=120,h.nc&&i.setAttribute("nonce",h.nc),i.src=h.p+"MiniValine."+({0:"npm.style-loader",1:"npm.highlight.js",3:"barrager",4:"body-DesertsP",5:"body-xCss",6:"lib",7:"math",8:"md",9:"md-style",10:"npm.leancloud-storage",11:"npm.marked",12:"style-DesertsP",13:"style-barrager",14:"style-dark",15:"style-xCss",16:"ua",17:"vcard-DesertsP",18:"vcard-barrager",19:"vendors~lib",20:"vendors~xss",21:"visitor",22:"xss"}[o]||o)+".min.js",r=new Error,t=function(e){i.onerror=i.onload=null,clearTimeout(a);var t,n=g[o];0!==n&&(n&&(t=e&&("load"===e.type?"missing":e.type),e=e&&e.target&&e.target.src,r.message="Loading chunk "+o+" failed.\n("+t+": "+e+")",r.name="ChunkLoadError",r.type=t,r.request=e,n[1](r)),g[o]=void 0)},a=setTimeout(function(){t({type:"timeout",target:i})},12e4),i.onerror=i.onload=t,document.head.appendChild(i))),Promise.all(n)},h.m=c,h.c=f,h.d=function(e,t,n){h.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},h.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.t=function(t,e){if(1&e&&(t=h(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(h.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)h.d(n,o,function(e){return t[e]}.bind(null,o));return n},h.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return h.d(t,"a",t),t},h.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},h.p="https://cdn.jsdelivr.net/npm/minivaline@4.2.11/dist/",h.oe=function(e){throw console.error(e),e};var k=(j=window.webpackJsonpMiniValine=window.webpackJsonpMiniValine||[]).push.bind(j);j.push=d;for(var j=j.slice(),l=0;l<j.length;l++)d(j[l]);var m=k;return h(h.s=9)});